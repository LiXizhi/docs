## 《秘密花园》第四节
 
提示：如视频播放不了，可在课程项目世界里，点击“讲解回放”进行观看。
 
<video width="100%" controls controlslist="nodownload nofullscreen noremoteplayback" disablePictureInPicture>
  <source src="https://api.keepwork.com/ts-storage/siteFiles/21813/raw#秘密花园L4.webm" type="video/webm" />
  <source src="https://api.keepwork.com/ts-storage/siteFiles/21814/raw#秘密花园L4.mp4" type="video/mp4" />
   
  你的浏览器不支持播放
</video>
<style>
video::-webkit-media-controls-fullscreen-button { display: none; } 
</style>

### 步骤一

在上一节课，我们已经学会了如何设计迷宫的机关门
那这节课，我们来学习如何制作机关门组合
首先，全选舞台左侧的方块
保存为bmax模型，并命名为door1
这样，就得到了一个L型的通道模块
点击不可拖动，修改为可拖动
然后，先右键放置一块在右侧的通道中
调整为合适的大小
打开属性面板，设置它为有真实物理
并添加点击事件，选择点击效果为开/关门
设置完毕后，点击L型机关门，看看效果
第一块设置好后，我们接着在右侧通道中
以相同的方法放置第二道和第三道L型机关门
需要注意的是，为了保证在旋转时，L型机关门组合契合通道的出口
第三道L型机关门需要调整下方向，修改为180度方向
这样，三个L型机关门就形成了一个机关门组合
点击旋转它们到合适角度，可以形成一个通道呢
我们来测试一下，看看实际效果吧

### 步骤二
为了让迷宫更加好玩，除了机关门组合
我们还可以添加迷宫NPC
比如添加一个会永远朝着玩家前进的小怪物，是不是也不错呢？
下面，我们就来实现这个效果吧！
首先，点击打开场景中的机关门
然后，点击E按钮，打开工具栏
使用活动模型工具，从模型库中添加一个喜欢的角色，比如选择这个火蝎子
将它放置于场景中，调整它到合适大小，并给它命名为npc
有了名字之后，我们就可以使用代码方块编程控制它了
接着，打开工具栏，添加一个代码方块到场景中
右键打开代码方块，它的旁边会自动添加一个电影方块和默认演员
点击图块，切换到图块编辑模式
将控制项下的【成为当前玩家的化身】指令拖过来，修改参数为npc
这样，默认演员就成为了角色npc的化身
将【永远重复】指令和【转向最近玩家】指令拖过来，让角色一直转向主角
再添加一条【向前走】指令，实现npc永远朝着主角前进的效果
最后，再添加一个侦测效果
如果主角不小心被npc碰到，那就提示碰到怪物，游戏结束，并且程序结束
程序编写好后，我们点击运行，测试一下实际效果
可以看到，方块和机关门都可以挡住npc的前进
所以我们需要控制主角巧妙地绕开它，才能顺利走出迷宫呢

### 步骤三

这是一个完整度比较高的迷宫
它除了迷宫特有的弯曲道路，还包含了机关门、机关组合门及迷宫npc
现在，大家可以启动拉杆，运行游戏，并好好体验一下这个游戏吧
同时，也请大家好好思考一下，你自己的迷宫还能如何优化以及升级呢？
别忘了，也要好好改造升级属于你自己的迷宫喔！
