## 《音乐之声》第二节
 
提示：如视频播放不了，可在课程项目世界里，点击“讲解回放”进行观看。
 
<video width="100%" controls controlslist="nodownload nofullscreen noremoteplayback" disablePictureInPicture>
  <source src="https://api.keepwork.com/ts-storage/siteFiles/21842/raw#音乐之声L2.webm" type="video/webm" />
  <source src="https://api.keepwork.com/ts-storage/siteFiles/21841/raw#音乐之声L2.mp4" type="video/mp4" />
   
  你的浏览器不支持播放
</video>
<style>
video::-webkit-media-controls-fullscreen-button { display: none; } 
</style>


### 步骤一

在上一节课中，我们学习了使用活动模型实现琴键点击播放音符的效果
在场景中，放置好了一组琴键
启动旁边的拉杆，激活代码方块
点击琴键，可以播放对应的音符声音
接下来，我们来学习一条指令，实现自动播放音符的效果
打开工具栏，添加一组代码方块和电影方块到场景中
打开代码方块，在控制项下，找到【循环变量】指令，把它拖过来
这条指令是指变量i从1开始每次增加1，增加到10结束
变量名i我们可以换成任意变量名，1是起始值，10是结束值
可以根据实际的情况修改
这里，我们要播放从1到7一共7个音符，所以我们把参数10改为7
然后，把播放音符指令拖过来
修改音符参数为变量i
点击运行，可以听到“哆瑞咪发嗦啦西”这7个音
为了听的更加清晰，我们添加一条【等待1秒】指令
到这里，自动播放音符效果就实现了
关于【循环变量】指令的用法你学会了吗？


### 步骤二

上一小节，我们使用【循环变量】指令实现了自动播放音符的效果
场景中摆放了一架电子琴，左右两边各有一组琴键
点击它会播放对应的音符
不过，电子琴中间部分的白色琴键缺失了，需要我们来帮它补齐
点击拉杆，启动代码，可以看到在电子琴中间部分出现了一个白色琴键
这是提前给大家放置好的琴键角色，存放在电影方块中
这一小节，我们学习克隆的相关知识，配合【循环变量】指令
实现一次生成多个琴键的效果，给场景中的电子琴补齐白色琴键
我们先来了解一下【克隆】指令
关闭拉杆，打开代码方块
将数据项下的【克隆此角色】指令拖过来
【克隆】指令，可以在世界中复制出一个和母体一模一样的角色出来
【克隆】指令有两个参数，第一个是克隆对象，默认是此角色
第二个是需要传递的参数，关于参数的传递我们后面的课程再介绍
点击运行，可以看到好像没有什么变化呢
这是因为克隆体的初始位置会与母体重叠在一起
所以当琴键被克隆出来后，我们需要让琴键位移一定距离
这样才能看到被克隆出来的琴键呢
拖入【位移】指令，修改X轴方向的参数为0
Y轴方向参数不变
Z轴方向参数修改为1
点击运行，可以看到我们成功克隆出来一个琴键啦
不过两个琴键之间间隔太宽，我们再来调整下参数，让它位移少一点
点击运行，可以看到目前这个宽度是比较合适的
电子琴缺失了7个琴键，所以我们一共需要复制出7个琴键
如何实现这个效果呢？
我们可以使用上节课学习到的【循环变量】指令
在控制项下将【循环变量】指令拖过来，修改后面的参数为7
点击运行，我们可以看到直接复制出了7个琴键，并且琴键依次展开
为了不让本体和克隆体冲突，所以我们还需要把本体隐藏起来
将外观项下的【隐藏】指令拖过来，放置于第一行
关闭代码方块，开启拉杆，可以看到白色琴键依次生成并展开了
到这里，关于如何使用【克隆】指令生成琴键的方法你学会了吗？

### 步骤三

上一小节，我们学习了使用【克隆】指令生成琴键的方法
这一小节，我们来设置一下琴键的音符属性，用于播放音符
打开控制白色琴键的代码方块
将数据项下的【设置角色名字为】指令拖过来
【设置角色名字为】指令可以用来设置角色属性
第一个参数对应你要设置的属性名，第二个参数对应属性值
这里，我们将变量i的值作为琴键的音符属性
第一个琴键发出音符1的声音，第二个琴键发出音符2的声音，依次类推
属性设置好后，
我们拖出【当角色被克隆时】指令，放置到【克隆】指令的上方
【当角色被克隆时】指令，可以对克隆体进行编辑，这里面的代码会被克隆体执行
需要注意的是，【当角色被克隆时】指令一定要放在【克隆】指令的上方才能生效
这里，我们让琴键克隆体显示刚刚设置好的音符属性
拖出【说】指令
将数据项下的【获取角色名字】指令拖出来，作为【说】指令的第一个参数

### 步骤四

上一小节，我们设置好了琴键的音符属性
这一小节，我们通过获取琴键的音符属性来播放对应音符
打开工具栏，添加一个新的代码方块旁边
这个代码方块用来控制琴键声音，因为控制的都是琴键
所以这里我们不需要再添加电影方块
打开代码方块，点击图块，切换到图块编辑模式
将事件项下的【当演员被点击】指令拖过来
【当演员被点击】指令在角色被点击时会执行里面的程序
将声音项下的【播放音符】指令放置到【当演员被点击】指令里面
最后，将【获取角色名字】指令作为【播放音符】指令的第一个参数
这样，当琴键被点击时，就会播放对应音符的声音啦
关闭代码方块，开启拉杆
点击琴键，可以听到对应音符的声音
到这里，关于如何让琴键播放对应音符的效果就成功实现了
你也快去到你自己的音乐世界里，完善一下你的电子琴吧！
下一节课，我们将了解如何给曲子进行数字编码并让电子琴弹奏出来哦


